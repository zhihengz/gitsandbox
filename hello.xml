<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs >
    <Require feature="googleapis"/>
    <Require feature="locked-domain"/>
    <Require feature="views"/>
    <Require feature="flash"/>
  </ModulePrefs>
<Content view="canvas" type="html"><![CDATA[

<script>
var gameUtils = {};

gameUtils.getInitialScopes = function() {
  return [ 'https://www.googleapis.com/auth/emeraldsea.circles.read',
           'https://www.googleapis.com/auth/userinfo.profile' ]
};

// Passed in as the callback to the appsapi script
gameUtils.ApisAreReady = function(loggedIn) {

  console.log('ApisAreReady, loggedIn: ' + loggedIn);
  if (loggedIn) {
    console.log( "logged in" );
  } else {
    alert( "I am not signed in" );
  }
};


gameUtils.sendPost = function (){
  var callback = function(r) { console.log(r); };
  console.log("I got here" );
  google.sendPost({
    title: 'I lost the game',
    body: 'The body of the post',
    anchorText: 'Play A Game Now',
    params : {'skippreview' : 'true' },
    images: ['http://com-ea2d-oz.s3.amazonaws.com/dal-ozdev/icon200x240.png']},
    callback    
  );
}

</script>
<script src="https://apps.sandbox.google.com/js/appsapi.js?container=gcjs&c=2&debug=1">
  {
    'appsapi': {},
    'appsutil': {
      'apis_are_ready': gameUtils.ApisAreReady,
      'required_scopes': gameUtils.getInitialScopes()
     },
     'poclient': {
       'update_session': google.updateSessionCallback
     }
  }
</script>
<div id="game">
  <h1>
  hello world
  </h1>
  <div>
    <a href="javascript:gameUtils.sendPost()">send post</a>
  </div>
</div>
]]>
</Content>
</Module>
